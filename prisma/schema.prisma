generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Cabeceras {
  id           Int          @id @default(autoincrement())
  texto        String?
  imagen       String?
  documento    String?
  video        String?
  typoCabecera TypoCabecera @default(TEXT)
  createdAt    DateTime     @default(now())
  updatedAt    DateTime
  Mensajes     Mensajes?
}

model Clientes {
  id              Int             @id @default(autoincrement())
  nombre          String
  apellido        String
  nombreEmpresa   String?
  whatsapp        String          @unique
  email           String?         @unique
  num1            Int?
  num2            Int?
  text1           String?
  text2           String?
  date1           DateTime?
  date2           DateTime?
  conversacionId  Int?            @unique
  ultimoMensajeId Int?            @unique
  createdAt       DateTime        @default(now())
  updatedAt       DateTime
  Conversaciones  Conversaciones? @relation(fields: [conversacionId], references: [id])
  Mensajes        Mensajes?       @relation(fields: [ultimoMensajeId], references: [id])
}

model Conversaciones {
  id        Int        @id @default(autoincrement())
  nombre    String
  categoria String
  active    Boolean?   @default(false)
  createdAt DateTime   @default(now())
  updatedAt DateTime
  Clientes  Clientes?
  Mensajes  Mensajes[]
}

model Mensajes {
  id             Int            @id @default(autoincrement())
  conversacionId Int
  palabrasClave  String
  cabeceraId     Int?           @unique
  cuerpo         String
  footer         String?
  predecesorId   Int?
  anyWord        Boolean        @default(false)
  createdAt      DateTime       @default(now())
  updatedAt      DateTime
  Cabeceras      Cabeceras?     @relation(fields: [cabeceraId], references: [id])
  Conversaciones Conversaciones @relation(fields: [conversacionId], references: [id])
  Mensajes       Mensajes?      @relation("MensajesToMensajes_predecesorId", fields: [predecesorId], references: [id])
  Clientes       Clientes?
  other_Mensajes Mensajes[]     @relation("MensajesToMensajes_predecesorId")
}

model MensajeLogs {
  id         Int      @id @default(autoincrement())
  mensajeId  String   @unique
  status     String
  recipentId String
  createdAt  DateTime @default(now())
  updatedAt  DateTime
}

enum TypoCabecera {
  TEXT
  MEDIA
}
